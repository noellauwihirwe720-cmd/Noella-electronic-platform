<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noella Electronics - Kigali's Trusted Electronics Store</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --light-bg: #ecf0f1;
            --admin-color: #9b59b6;
        }

        /* Navbar */
        .navbar {
            background: var(--primary-color);
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo h1 {
            font-size: 1.8rem;
            margin-bottom: 0.2rem;
        }

        .tagline {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            padding: 0.5rem 0;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--secondary-color);
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
        }

        #cartCount {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.7rem;
        }

        /* Admin Button in Navbar */
        .admin-nav-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 8px 18px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }

        .admin-nav-btn:hover {
            transform: translateY(-2px);
            background: linear-gradient(135deg, #c0392b, #e74c3c);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .hero-content h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .hero-content p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: transform 0.3s, box-shadow 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        /* Categories */
        .categories {
            max-width: 1200px;
            margin: 4rem auto;
            padding: 0 20px;
        }

        .categories h2 {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary-color);
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }

        .category-card {
            text-align: center;
            padding: 2rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-5px);
        }

        .category-card .emoji {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .category-card p {
            color: #666;
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }

        /* Products Grid */
        .featured-products {
            max-width: 1200px;
            margin: 4rem auto;
            padding: 0 20px;
        }

        .featured-products h2 {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary-color);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .image-container {
            width: 100%;
            height: 220px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            padding: 1rem;
        }

        .product-image {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        .product-info {
            padding: 1.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .product-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .product-category {
            display: inline-block;
            background: var(--light-bg);
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            text-transform: capitalize;
            align-self: flex-start;
        }

        .price-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 1rem 0;
        }

        .product-price {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .product-stock {
            font-size: 0.85rem;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            background: #e8f5e9;
            color: var(--success-color);
            font-weight: 600;
        }

        .product-stock.out {
            background: #ffebee;
            color: var(--accent-color);
        }

        .add-to-cart {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            margin-top: auto;
        }

        .add-to-cart:hover {
            background: #2980b9;
        }

        .add-to-cart:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        /* Flash Sale */
        .flash-sale {
            background: linear-gradient(145deg, #ff6b6b, #ff4757);
            color: white;
            padding: 3rem;
            text-align: center;
            margin: 4rem 0;
        }

        .sale-content h3 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .countdown {
            font-size: 2rem;
            font-weight: 700;
            margin-top: 1rem;
            font-family: monospace;
        }

        /* Footer */
        footer {
            background: var(--primary-color);
            color: white;
            padding: 1.5rem 0;
            margin-top: 2rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .weather-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .search-box {
            display: flex;
            gap: 0.5rem;
        }

        .search-box input {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            width: 200px;
        }

        .search-box button {
            padding: 8px 15px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .datetime {
            font-size: 0.9rem;
        }

        /* Floating Admin Button */
        #floatingAdminBtn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 9999;
            font-size: 1.8rem;
            border: 3px solid rgba(255,255,255,0.3);
        }

        #floatingAdminBtn:hover {
            transform: scale(1.1);
        }

        #adminTooltip {
            position: fixed;
            bottom: 100px;
            right: 30px;
            background: #2c3e50;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            display: none;
            z-index: 9999;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 15px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f0f0f0;
        }

        .close:hover {
            background: #e0e0e0;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .cart-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
        }

        .quantity-btn {
            width: 35px;
            height: 35px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
        }

        .cart-total {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: right;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .no-products {
            text-align: center;
            padding: 3rem;
            color: #666;
            grid-column: 1 / -1;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: #666;
            grid-column: 1 / -1;
        }

        .admin-note {
            text-align: center;
            margin-top: 1rem;
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .admin-note a {
            color: white;
            text-decoration: none;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 9999;
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            background: #27ae60;
        }

        .notification.error {
            background: #e74c3c;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <h1>Noella Electronics</h1>
                <span class="tagline">Your Trusted Electronic Store in Kigali</span>
            </div>
            
            <div class="nav-links">
                <a href="index.html" class="active">Home</a>
                <a href="products.html">Products</a>
                <a href="about.html">About Us</a>
                <a href="contact.html">Contact</a>
                <div class="cart-icon" onclick="viewCart()">
                    üõí <span id="cartCount">0</span>
                </div>
                <a href="admin_login.html" class="admin-nav-btn">üîë Admin</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h2>Best Electronic Devices at Affordable Prices</h2>
            <p>Phones, Laptops, TVs, Speakers, Headphones & More</p>
            <a href="products.html" class="btn btn-primary">Shop Now</a>
        </div>
    </section>

    <!-- Featured Categories -->
    <section class="categories">
        <h2>Shop by Category</h2>
        <div class="category-grid" id="categoryGrid"></div>
    </section>

    <!-- Featured Products -->
    <section class="featured-products">
        <h2>Featured Products</h2>
        <div class="products-grid" id="featuredProducts">
            <div class="loading">Loading products...</div>
        </div>
    </section>

    <!-- Flash Sale Banner -->
    <section class="flash-sale">
        <div class="sale-content">
            <h3>‚ö° FLASH SALE ‚ö°</h3>
            <p>Up to 30% off on selected items</p>
            <div class="countdown" id="countdown"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="weather-info">
                <span>‚òÅÔ∏è</span>
                <span>22¬∞C Kigali</span>
            </div>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search products...">
                <button onclick="searchProducts()">üîç</button>
            </div>
            <div class="datetime" id="currentDateTime"></div>
        </div>
        <div class="admin-note">
            <a href="about.html">üìå Learn more about Noella Electronics</a>
        </div>
    </footer>

    <!-- Floating Admin Login Button -->
    <div id="floatingAdminBtn" onclick="window.location.href='admin_login.html'">üîë</div>
    <div id="adminTooltip">Admin Login</div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCartModal()">&times;</span>
            <h2>Your Cart</h2>
            <div id="cartItems"></div>
            <div class="cart-total">
                <strong>Total: <span id="cartTotal">0</span> RWF</strong>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="checkout()" style="flex: 2;">‚úÖ Checkout</button>
                <button class="btn" onclick="closeCartModal()" style="flex: 1; background: #95a5a6;">‚úñ Close</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIGURATION ====================
        const EMAILJS_CONFIG = {
            PUBLIC_KEY: "agAYd3IPoo9KYbNZF",
            SERVICE_ID: "noellashop",
            ADMIN_TEMPLATE: "template_wuzlm43",
            CUSTOMER_TEMPLATE: "template_0ga6z7o"
        };

        const ADMIN_EMAIL = "noella.electronics@outlook.com";
        
        if (typeof emailjs !== 'undefined') {
            emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY);
        }

        // ==================== GLOBAL VARIABLES ====================
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let products = [];

        // ==================== FLOATING BUTTON TOOLTIP ====================
        document.getElementById('floatingAdminBtn').addEventListener('mouseenter', function() {
            document.getElementById('adminTooltip').style.display = 'block';
        });
        document.getElementById('floatingAdminBtn').addEventListener('mouseleave', function() {
            document.getElementById('adminTooltip').style.display = 'none';
        });

        // ==================== SHOW NOTIFICATION ====================
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        // ==================== LOAD PRODUCTS - FIXED WITH FALLBACK ====================
        function loadProducts() {
            const grid = document.getElementById('featuredProducts');
            
            // Get products from localStorage (your uploaded products)
            let storedProducts = JSON.parse(localStorage.getItem('products')) || [];
            products = storedProducts;
            
            console.log('Loaded products:', products.length);
            
            if (products.length === 0) {
                // If no products, show message but don't add default products
                grid.innerHTML = '<div class="no-products">No products available. Please check back later.</div>';
                return;
            }
            
            // Show first 8 products
            const featuredProducts = products.slice(0, 8);
            displayProducts(featuredProducts);
        }

        // ==================== DISPLAY PRODUCTS WITH FALLBACK IMAGES ====================
        function displayProducts(productsToShow) {
            const grid = document.getElementById('featuredProducts');
            
            if (!productsToShow || productsToShow.length === 0) {
                grid.innerHTML = '<div class="no-products">No products available</div>';
                return;
            }
            
            let html = '';
            productsToShow.forEach(p => {
                // Add fallback image if main image fails to load
                html += `
                    <div class="product-card">
                        <div class="image-container">
                            <img src="${p.imageUrl}" 
                                 alt="${p.name}" 
                                 class="product-image" 
                                 onerror="this.src='https://via.placeholder.com/300?text=No+Image'">
                        </div>
                        <div class="product-info">
                            <h3 class="product-title">${p.name}</h3>
                            <span class="product-category">üìå ${p.category}</span>
                            <div class="price-section">
                                <span class="product-price">${Number(p.price).toLocaleString()} RWF</span>
                                <span class="product-stock ${p.quantity === 0 ? 'out' : ''}">
                                    ${p.quantity > 0 ? '‚úÖ In Stock' : '‚ùå Out of Stock'}
                                </span>
                            </div>
                            <button class="add-to-cart" 
                                    onclick="addToCart(${p.id})"
                                    ${p.quantity === 0 ? 'disabled' : ''}>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                `;
            });
            grid.innerHTML = html;
        }

        // ==================== ADD TO CART ====================
        window.addToCart = function(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;
            
            const existing = cart.find(i => i.id === id);
            
            if (existing) {
                if (existing.quantity < product.quantity) {
                    existing.quantity++;
                } else {
                    showNotification('Not enough stock!', 'error');
                    return;
                }
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    quantity: 1,
                    maxQuantity: product.quantity,
                    image: product.imageUrl
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            showNotification(`${product.name} added to cart!`);
        };

        // ==================== UPDATE CART COUNT ====================
        function updateCartCount() {
            const count = cart.reduce((t, i) => t + i.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        // ==================== VIEW CART ====================
        window.viewCart = function() {
            const modal = document.getElementById('cartModal');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p style="text-align:center; padding:20px;">Your cart is empty</p>';
                cartTotal.textContent = '0';
            } else {
                let html = '';
                let total = 0;
                
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    
                    html += `
                        <div class="cart-item">
                            <div style="display:flex; align-items:center; gap:10px; flex:2;">
                                <img src="${item.image}" style="width:50px; height:50px; object-fit:cover;" onerror="this.src='https://via.placeholder.com/50'">
                                <div>
                                    <h4>${item.name}</h4>
                                    <p>${item.price.toLocaleString()} RWF each</p>
                                </div>
                            </div>
                            <div style="display:flex; align-items:center; gap:10px;">
                                <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)" ${item.quantity <= 1 ? 'disabled' : ''}>‚àí</button>
                                <span style="font-weight:bold;">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)" ${item.quantity >= item.maxQuantity ? 'disabled' : ''}>+</button>
                            </div>
                        </div>
                    `;
                });
                
                cartItems.innerHTML = html;
                cartTotal.textContent = total.toLocaleString();
            }
            
            modal.style.display = 'block';
        };

        // ==================== UPDATE QUANTITY ====================
        window.updateQuantity = function(id, change) {
            const index = cart.findIndex(i => i.id === id);
            if (index === -1) return;
            
            const newQty = cart[index].quantity + change;
            
            if (newQty === 0) {
                cart.splice(index, 1);
            } else if (newQty <= cart[index].maxQuantity) {
                cart[index].quantity = newQty;
            } else {
                showNotification('Maximum stock reached!', 'error');
                return;
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            viewCart();
        };

        // ==================== CHECKOUT ====================
        window.checkout = function() {
            if (cart.length === 0) {
                showNotification('Your cart is empty!', 'error');
                return;
            }
            
            localStorage.setItem('pendingOrder', JSON.stringify(cart));
            window.location.href = 'contact.html?checkout=true';
        };

        // ==================== CLOSE CART MODAL ====================
        window.closeCartModal = function() {
            document.getElementById('cartModal').style.display = 'none';
        };

        // ==================== SEARCH ====================
        window.searchProducts = function() {
            const term = document.getElementById('searchInput').value.trim();
            if (term) {
                window.location.href = `products.html?search=${encodeURIComponent(term)}`;
            }
        };

        // ==================== DATE/TIME ====================
        function updateDateTime() {
            const now = new Date();
            document.getElementById('currentDateTime').innerHTML = 
                now.toLocaleTimeString() + ' ‚Ä¢ ' + now.toLocaleDateString();
        }

        // ==================== COUNTDOWN ====================
        function startCountdown() {
            const el = document.getElementById('countdown');
            const end = Date.now() + 86400000;
            setInterval(() => {
                const d = end - Date.now();
                if (d < 0) el.innerHTML = 'SALE ENDED';
                else el.innerHTML = `${Math.floor(d/3600000)}h ${Math.floor((d%3600000)/60000)}m ${Math.floor((d%60000)/1000)}s`;
            }, 1000);
        }

        // ==================== LOAD CATEGORIES ====================
        function loadCategories() {
            const categories = [
                {name:'Phones', emoji:'üì±', cat:'phones', desc:'Latest smartphones from top brands'},
                {name:'Laptops', emoji:'üíª', cat:'laptops', desc:'Powerful laptops for work & play'},
                {name:'TVs', emoji:'üì∫', cat:'tvs', desc:'4K Smart TVs with stunning picture'},
                {name:'Speakers', emoji:'üîä', cat:'speakers', desc:'Premium sound for every space'},
                {name:'Headphones', emoji:'üéß', cat:'headphones', desc:'Wireless and noise-cancelling'}
            ];
            
            document.getElementById('categoryGrid').innerHTML = categories.map(c => 
                `<div class="category-card" onclick="window.location.href='products.html?category=${c.cat}'">
                    <div class="emoji">${c.emoji}</div>
                    <h3>${c.name}</h3>
                    <p>${c.desc}</p>
                </div>`
            ).join('');
        }

        // ==================== INITIALIZE ====================
        document.addEventListener('DOMContentLoaded', () => {
            loadCategories();
            loadProducts();
            updateCartCount();
            updateDateTime();
            startCountdown();
            setInterval(updateDateTime, 1000);
        });
    </script>
</body>
</html>
